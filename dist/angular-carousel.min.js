/**
 * Angular Carousel - Mobile friendly touch carousel for AngularJS
 * @version v0.2.4 - 2014-07-25
 * @link http://revolunet.github.com/angular-carousel
 * @author Julien Bouquillon <julien@revolunet.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
angular.module("angular-carousel",["ngTouch"]);
angular.module("angular-carousel").directive("rnCarouselAutoSlide",["$timeout",function(c){return{restrict:"A",link:function(d,h,x){var z=Math.round(1E3*parseFloat(x.rnCarouselAutoSlide)),m=increment=!1,q=h.children().length;d.carouselExposedIndex||(d.carouselExposedIndex=0);stopAutoplay=function(){angular.isDefined(m)&&c.cancel(m);m=void 0};increment=function(){d.carouselExposedIndex=d.carouselExposedIndex<q-1?d.carouselExposedIndex+1:0};restartTimer=function(){stopAutoplay();m=c(increment,z)};d.$watch("carouselIndex",
function(){restartTimer()});restartTimer();x.rnCarouselPauseOnHover&&"false"!=x.rnCarouselPauseOnHover&&(h.on("mouseenter",stopAutoplay),h.on("mouseleave",restartTimer));d.$on("$destroy",function(){stopAutoplay();h.off("mouseenter",stopAutoplay);h.off("mouseleave",restartTimer)})}}}]);
angular.module("angular-carousel").directive("rnCarouselControls",[function(){return{restrict:"A",replace:!0,scope:{items:"=",index:"=",loop:"="},link:function(c,d,h){c.prev=function(){c.index=c.index?c.index-1:c.items.length};c.next=function(){c.index=(c.index+1)%c.items.length}},templateUrl:"carousel-controls.html"}}]);angular.module("angular-carousel").run(["$templateCache",function(c){c.put("carousel-controls.html",'<div class="rn-carousel-controls" mn-touch swipe-right="prev()" swipe-left="next()">\n  <span class="rn-carousel-control rn-carousel-control-prev" ng-click="prev();$event.stopPropagation();" ng-if="items.length > 1 && (index > 0  || loop)"></span>\n  <span class="rn-carousel-control rn-carousel-control-next" ng-click="next();$event.stopPropagation();" ng-if="items.length > 1 && (index < items.length - 1 || loop)"></span>\n</div>')}]);
angular.module("angular-carousel").directive("rnCarouselIndicators",[function(){return{restrict:"A",replace:!0,scope:{items:"=",index:"="},templateUrl:"carousel-indicators.html"}}]);angular.module("angular-carousel").run(["$templateCache",function(c){c.put("carousel-indicators.html",'<div class="rn-carousel-indicator">\n <span ng-repeat="item in items" ng-click="$parent.index=$index" ng-class="{active: $index==$parent.index}"></span>\n</div>')}]);
(function(){angular.module("angular-carousel").directive("rnCarousel",["$swipe","$window","$document","$parse","$compile","$rootScope",function(c,d,h,x,z,m){var q=0,G=d.requestAnimationFrame||d.webkitRequestAnimationFrame||d.mozRequestAnimationFrame;return{restrict:"A",scope:!0,compile:function(r,t){var H=r.children()[0].attributes,U=!1,V=!1,I=!1,W=angular.isDefined(t.rnCarouselLoop),n,J;r.addClass("rn-carousel-slides");r.children().addClass("rn-carousel-slide");["ng-repeat","data-ng-repeat","x-ng-repeat"].every(function(b){b=
H[b];if(angular.isDefined(b)){var c=b.value.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),d=c[3];n=c[1];J=c[2];if(n)return angular.isDefined(t.rnCarouselBuffered)&&(V=!0,b.value=n+" in "+J+"|carouselSlice:carouselBufferIndex:carouselBufferSize",d&&(b.value+=" track by "+d)),U=!0,!1}return!0});return function(b,r,f,A){function n(){for(var a=[],c=0;c<e;c++)a[c]=c;b.carouselIndicatorArray=a}function K(){B.css("width","100%");var a;a=u.children();0===a.length?g=u[0].getBoundingClientRect().width:
(g=a[0].getBoundingClientRect().width,0===g&&L&&(g=L));(a=g)&&B.css("width",a+"px")}function M(a){isNaN(a)&&(a=b.carouselIndex*g);p=a;a=-Math.round(p);a+=b.carouselBufferIndex*g;u[0].style[N]=Z?"translate3d("+a+"px, 0, 0)":"translate("+a+"px, 0)"}function X(){var a;y&&(a=Date.now()-O,a=y*Math.exp(-a/75),3<a||-3>a?(M(v-a),G(X)):l(v/g))}function l(a,c){angular.isDefined(t.rnCarouselSeamlessLoop)&&P&&(angular.isDefined(t.rnCarouselBuffered)&&3===Q||!angular.isDefined(t.rnCarouselBuffered)&&4===Q)&&(a=
1,b.carouselIndex=1,P=!1);Q++;isNaN(a)&&(a=b.carouselIndex);if(c)p=a*g,C(null,null,!0);else{b.carouselIndex=a>=e?e:0>=a?0:a;var d=0,k=(b.carouselBufferSize-1)/2;V&&(d=b.carouselIndex<=k?0:e<b.carouselBufferSize?0:b.carouselIndex>e-b.carouselBufferSize?e-b.carouselBufferSize:b.carouselIndex-k);b.carouselBufferIndex=d;"$apply"!==m.$$phase&&"$digest"!==m.$$phase&&(I?b.$apply():b.$digest());M();angular.isDefined(t.rnCarouselSeamlessLoop)&&!P&&(0==b.carouselIndex&&0==a&&l(e-2),b.carouselIndex==e-1&&a==
e-1&&l(1))}}function R(a){D=!0;C({x:a.clientX,y:a.clientY},a)}function H(a,b){h.bind("mouseup",R);S=!0;T=a.x;y=0;O=Date.now();return!1}function aa(a,c){var d,k;S&&(d=a.x,k=T-d,2<k||-2>k)&&(D=!0,T=d,G(function(){var a=p+k;0===b.carouselIndex?a=Math.max(-(.05*g),a):b.carouselIndex===e-1&&(a=Math.min((e-1)*g+.05*g,a));M(a)}));return!1}function C(a,c,d){if(!c||D){h.unbind("mouseup",R);D=S=!1;v=p;var k=.05*g;a=b.carouselIndex*g;var f=a-v;c=-Math[0<=f?"ceil":"floor"](f/g);k=Math.abs(f)>k;c+b.carouselIndex>=
e&&(c=e-1-b.carouselIndex);0>c+b.carouselIndex&&(c=-b.carouselIndex);v=((k?c:0)+b.carouselIndex)*g;y=v-p;O=Date.now();d&&(y=p-a);G(X);return!1}}function E(){K();l()}q++;b.loop=W;var g,N,S,T,y,p=0,v,e=0,D=!1,Y=!0,O,u=r.wrap("<div id='carousel-"+q+"' class='rn-carousel-container'></div>"),B=u.parent();if(angular.isDefined(f.rnCarouselIndicator)||angular.isDefined(f.rnCarouselControl))n(),b.$watch("carouselIndex",function(a){b.indicatorIndex=a;b.carouselExposedIndex=a}),b.$watch("indicatorIndex",function(a){l(a,
!0)});angular.isDefined(f.rnCarouselPreventAnimation)&&(Y=!1);var L=null;angular.isDefined(f.rnCarouselDefaultSlideWidth)&&(L=parseInt(f.rnCarouselDefaultSlideWidth));b.$watch("carouselExposedIndex",function(a){l(a,!0)});angular.isDefined(f.rnCarouselIndicator)&&(A=z("<div id='carousel-"+q+"-indicator' index='indicatorIndex' items='carouselIndicatorArray' rn-carousel-indicators class='rn-carousel-indicator'></div>")(b),B.append(A));angular.isDefined(f.rnCarouselControl)&&(A=z("<div id='carousel-"+
q+"-controls' index='indicatorIndex' loop="+W+" items='carouselIndicatorArray' rn-carousel-controls class='rn-carousel-controls'></div>")(b),B.append(A));b.carouselBufferIndex=0;b.carouselBufferSize=5;b.carouselIndex=0;if(f.rnCarouselIndex){var w=x(f.rnCarouselIndex);angular.isFunction(w.assign)?(b.$watch("carouselIndex",function(a){w.assign(b.$parent,a)}),b.carouselIndex=w(b),b.$parent.$watch(w,function(a,c){void 0!==a&&(a>=e?(a=e-1,w.assign(b.$parent,a)):0>a&&(a=0,w.assign(b.$parent,a)),l(a,Y))}),
I=!0):isNaN(f.rnCarouselIndex)||(b.carouselIndex=parseInt(f.rnCarouselIndex,10))}U?b.$watchCollection(J,function(a,c){e=0;angular.isArray(a)?e=a.length:angular.isObject(a)&&(e=Object.keys(a).length);n();g||K();l(b.carouselIndex)}):(e=r.children().length,n(),K());var P=f.rnCarouselIndex?!1:!0,Q=0;f.$observe("rnCarouselSwipe",function(a,b){"false"!==a&&"off"!==a?c.bind(u,{start:H,move:aa,end:C,cancel:function(a){C({},a)}}):u.unbind()});I||l(b.carouselIndex);N="transform";["webkit","Moz","O","ms"].every(function(a){a+=
"Transform";return"undefined"!==typeof document.body.style[a]?(N=a,!1):!0});var Z=function(){var a=document.createElement("p"),b,c={webkitTransform:"-webkit-transform",msTransform:"-ms-transform",transform:"transform"};document.body.insertBefore(a,null);for(var d in c)void 0!==a.style[d]&&(a.style[d]="translate3d(1px,1px,1px)",b=window.getComputedStyle(a).getPropertyValue(c[d]));document.body.removeChild(a);return void 0!==b&&0<b.length&&"none"!==b}(),F=angular.element(d);F.bind("orientationchange",
E);F.bind("resize",E);b.$on("$destroy",function(){h.unbind("mouseup",R);F.unbind("orientationchange",E);F.unbind("resize",E)})}}}}])})();(function(){angular.module("angular-carousel").filter("carouselSlice",function(){return function(c,d,h){if(angular.isArray(c))return c.slice(d,d+h);if(angular.isObject(c))return c}})})();
